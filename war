#include <stdio.h>
#include <string.h>
#include <stdlib.h>   // precisa pro rand()
#include <time.h>     // precisa pro srand()

typedef struct {
    char nome[20];
    int dono;        // 1 = Am√©rica do Sul | 2 = Europa
    int exercitos;
} Territorio;

int main() {
   
    srand(time(NULL));
Territorio *territorios = (Territorio *) calloc(6, sizeof(Territorio));
if (territorios == NULL){
    printf("erro ao alocar memoria/n");
    return 1;
}

int i;

    printf("Digite o nome dos 3 pa√≠ses da Am√©rica do Sul:\n");
    for (i = 0; i < 3; i++) {
        printf("Pa√≠s %d: ", i + 1);
        fgets(territorios[i].nome, 20, stdin);
        territorios[i].nome[strcspn(territorios[i].nome, "\n")] = '\0';
        territorios[i].dono = 1;
        territorios[i].exercitos = 5;
    }

    printf("\nDigite o nome dos 3 pa√≠ses da Europa:\n");
    for (i = 3; i < 6; i++) {
        printf("Pa√≠s %d: ", i - 2);
        fgets(territorios[i].nome, 20, stdin);
        territorios[i].nome[strcspn(territorios[i].nome, "\n")] = '\0';
        territorios[i].dono = 2;
        territorios[i].exercitos = 5;
    }

    int opcao;

    while (1) { // repete o jogo at√© o jogador parar
        printf("\n===== MAPA =====\n");
        for (i = 0; i < 6; i++) {
            printf("%d. %-12s | Dono: Jogador %d | Ex√©rcitos: %d\n",
                   i + 1, territorios[i].nome, territorios[i].dono, territorios[i].exercitos);
        }

        printf("\n1 - Atacar\n2 - Refor√ßar\n3 - Sair\nEscolha: ");
        scanf("%d", &opcao);

        if (opcao == 3) {
            printf("Saindo do jogo...\n");
            break;
        }

        if (opcao == 2) {  // ü™ñ REFOR√áAR
            int pais;
            printf("\nEscolha o n√∫mero do seu territ√≥rio para refor√ßar: ");
            scanf("%d", &pais);
            pais--; // ajustar √≠ndice (pois come√ßa em 0)

            if (pais >= 0 && pais < 6) {
                territorios[pais].exercitos += 1;
                printf("Voc√™ refor√ßou %s! Agora tem %d ex√©rcitos.\n",
                       territorios[pais].nome, territorios[pais].exercitos);
            } else {
                printf("Territ√≥rio inv√°lido!\n");
            }
        }

        if (opcao == 1) {  // ‚öîÔ∏è ATACAR
            int atacante, defensor;
            printf("\nEscolha o n√∫mero do seu territ√≥rio atacante: ");
            scanf("%d", &atacante);
            atacante--;

            printf("Escolha o n√∫mero do territ√≥rio inimigo: ");
            scanf("%d", &defensor);
            defensor--;

            if (atacante < 0 || atacante >= 6 || defensor < 0 || defensor >= 6) {
                printf("N√∫mero inv√°lido!\n");
                continue;
            }

            if (territorios[atacante].dono == territorios[defensor].dono) {
                printf("Voc√™ n√£o pode atacar um territ√≥rio seu!\n");
                continue;
            }

            if (territorios[atacante].exercitos <= 1) {
                printf("Voc√™ precisa ter mais de 1 ex√©rcito para atacar!\n");
                continue;
            }

            // rola os dados
            int dadoAtacante = rand() % 6 + 1;
            int dadoDefensor = rand() % 6 + 1;

            printf("\n%s (Jogador %d) tirou %d no dado.\n",
                   territorios[atacante].nome, territorios[atacante].dono, dadoAtacante);
            printf("%s (Jogador %d) tirou %d no dado.\n",
                   territorios[defensor].nome, territorios[defensor].dono, dadoDefensor);

            if (dadoAtacante > dadoDefensor) {
                territorios[defensor].exercitos -= 1;
                printf("Ataque venceu! %s perdeu 1 ex√©rcito.\n", territorios[defensor].nome);

                // se o inimigo perdeu todos os ex√©rcitos, o territ√≥rio muda de dono
                if (territorios[defensor].exercitos <= 0) {
                    printf("%s foi conquistado!\n", territorios[defensor].nome);
                    territorios[defensor].dono = territorios[atacante].dono;
                    territorios[defensor].exercitos = 1;
                    territorios[atacante].exercitos -= 1;
                }
            } else {
                territorios[atacante].exercitos -= 1;
                printf("Ataque falhou! %s perdeu 1 ex√©rcito.\n", territorios[atacante].nome);
            }
        }
    }

    free(territorios);

    return 0;
}